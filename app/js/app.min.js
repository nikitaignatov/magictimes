$(function(){function a(a){_.each(a,function(a,b){_.extend(a.Value,{Start:moment(a.Value.Transaction.Started,moment.ISO_8601).fromNow(),End:moment(a.Value.Transaction.Ended,moment.ISO_8601).fromNow(),Duration:moment.duration(a.Value.Transaction.Duration).humanize()})})}$.connection.hub.url="http://localhost:9000/signalr";var b=$.connection.nfcHub;b.client.register=function(a){console.log("who is:",a),b.server.register(a,prompt("Who is this?",""))};var c=$("#session-template").html(),d=$("#complete-session-template").html();b.client.update=function(b){a(b.new_sessions),a(b.ready_to_submit),a(b.complete),console.log(b),$(".total-hours-count").html(moment.duration(b.total_minutes,"minute").humanize()),$(".total-session-count").html(b.total_sessions),$(".total-question-count").html(b.total_questions),$("#missing-message").html(Mustache.to_html(c,{items:b.new_sessions})),$("#missing-ticket").html(Mustache.to_html(c,{items:b.ready_to_submit})),$("#complete").html(Mustache.to_html(d,{items:b.complete}))},b.client.log=function(a){console.log(a)},$.connection.hub.start().done(function(){$("body").on("click",".session-description button",function(){var a=$(this).parents(".box").find("[name=message]"),c=$(this).parents(".box").find("[name=ticket]"),d=$(this).parents(".box").data("id");b.server.commentOn(d,a.val(),c.val(),0)}),$("body").on("click",".session-description button.submit-entry",function(){var a=$(this).parents(".box").data("id");b.server.submitTimeEntry(a)}),$("body").on("click",".box button.remove-session",function(){var a=$(this).parents(".box").data("id");b.server.remove(a)})})});